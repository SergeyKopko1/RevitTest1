<Project Sdk="Microsoft.NET.Sdk">  
    <PropertyGroup>  
        <UseWPF>true</UseWPF>  
        <LangVersion>latest</LangVersion>  
        <PlatformTarget>x64</PlatformTarget>  
        <ImplicitUsings>true</ImplicitUsings>  
        <TargetFramework>net48</TargetFramework>  
        <Configurations>Debug R19;Debug R21;Debug R22;Debug R23;Debug R24;Release R21;Release R22;Release R23;Release R24;Debug Server;Debug R25</Configurations>  
        <Platforms>AnyCPU</Platforms>  
    </PropertyGroup>  
  
    <PropertyGroup Condition="$(Configuration.Contains('Debug'))">  
        <XamlDebuggingInformation>True</XamlDebuggingInformation>  
        <DebugSymbols>true</DebugSymbols>  
        <DebugType>full</DebugType>  
        <DefineConstants>$(DefineConstants);DEBUG</DefineConstants>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('Release'))">  
        <Optimize>true</Optimize>  
        <DebugType>pdbonly</DebugType>  
        <DefineConstants>$(DefineConstants);RELEASE</DefineConstants>  
    </PropertyGroup>  
      
    <PropertyGroup Condition="$(Configuration.Contains('R19'))">  
        <RevitVersion>2019</RevitVersion>  
        <DefineConstants>$(DefineConstants);R19</DefineConstants>  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2019\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <TargetFramework>net48</TargetFramework>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('R20'))">  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2020\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <RevitVersion>2020</RevitVersion>  
        <DefineConstants>$(DefineConstants);R20</DefineConstants>  
        <TargetFramework>net48</TargetFramework>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('R21'))">  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2021\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <RevitVersion>2021</RevitVersion>  
        <DefineConstants>$(DefineConstants);R21</DefineConstants>  
        <TargetFramework>net48</TargetFramework>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('R22'))">  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2022\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <RevitVersion>2022</RevitVersion>  
        <DefineConstants>$(DefineConstants);R22</DefineConstants>  
        <TargetFramework>net48</TargetFramework>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('R23'))">  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2023\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <RevitVersion>2023</RevitVersion>  
        <DefineConstants>$(DefineConstants);R23</DefineConstants>  
        <TargetFramework>net48</TargetFramework>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('R24'))">  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2024\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <RevitVersion>2024</RevitVersion>  
        <DefineConstants>$(DefineConstants);R24</DefineConstants>  
        <TargetFramework>net48</TargetFramework>  
    </PropertyGroup>  
    <PropertyGroup Condition="$(Configuration.Contains('R25'))">  
        <StartAction>Program</StartAction>  
        <StartProgram>C:\Program Files\Autodesk\Revit 2025\Revit.exe</StartProgram>  
        <StartArguments>/language ENG</StartArguments>  
        <RevitVersion>2025</RevitVersion>  
        <DefineConstants>$(DefineConstants);R25</DefineConstants>  
        <TargetFramework>net8.0-windows</TargetFramework>  
    </PropertyGroup>  
      
    <PropertyGroup>  
        <Version>$(RevitVersion)</Version>  
        <GenerateAssemblyInfo>true</GenerateAssemblyInfo>  
        <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>  
    </PropertyGroup>  
      
    <ItemGroup>  
        <Compile Remove="IExternalEvents\**" />  
        <EmbeddedResource Remove="IExternalEvents\**" />  
        <None Remove="IExternalEvents\**" />  
        <Page Remove="IExternalEvents\**" />  
    </ItemGroup>  
  
    <ItemGroup>  
          
        <Reference Include="RevitAPI">
          <HintPath>..\..\..\..\..\Program Files\Autodesk\Revit 2021\RevitAPI.dll</HintPath>
        </Reference>  
          
        <Reference Include="RevitAPIUI">
          <HintPath>..\..\..\..\..\Program Files\Autodesk\Revit 2021\RevitAPIUI.dll</HintPath>
        </Reference>  
          
        <Reference Include="System.ComponentModel.DataAnnotations" />  
        <Reference Include="System.Windows.Forms" />  
    </ItemGroup>  
  
    <ItemGroup>  
        <Page Update="Styles\StatusCombobox.xaml">  
            <Generator>MSBuild:Compile</Generator>  
            <XamlRuntime>Wpf</XamlRuntime>  
            <SubType>Designer</SubType>  
        </Page>  
        <Page Update="Views\CommentaryView.xaml">  
            <Generator>MSBuild:Compile</Generator>  
            <XamlRuntime>Wpf</XamlRuntime>  
            <SubType>Designer</SubType>  
        </Page>  
    </ItemGroup>  
  
    <ItemGroup>  
        <EmbeddedResource Update="Resources\Resources.resx">  
            <Generator>PublicResXFileCodeGenerator</Generator>  
            <LastGenOutput>Resources.Designer.cs</LastGenOutput>  
            <SubType>Designer</SubType>  
        </EmbeddedResource>  
    </ItemGroup>  
  
    <ItemGroup>  
        <Compile Update="Resources\Resources.Designer.cs">  
            <DesignTime>True</DesignTime>  
            <AutoGen>True</AutoGen>  
            <DependentUpon>Resources.resx</DependentUpon>  
        </Compile>  
    </ItemGroup>  
  
    <ItemGroup>  
        <None Remove="Resources\Images\Bimo.png" />  
        <PackageReference Include="Nice3point.Revit.Extensions" Version="2021.3.0" />  
        <Resource Include="Resources\Images\Bimo.png" />  
        <Resource Include="Resources\Icons\RibbonIcon16.png" />  
        <Resource Include="Resources\Icons\RibbonIcon32.png" />  
    </ItemGroup>  
  
    <ItemGroup>  
        <None Update="appconfig.json">  
            <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>  
        </None>  
    </ItemGroup>  
  
    <Target Name="RemoveLibrariesBeforeBuild" BeforeTargets="AfterBuild">  
        <ItemGroup>  
            <FilesToDelete Include="$(SolutionDir)**\Nice3Point.*.dll" />  
            <FilesToDelete Include="$(SolutionDir)**\ILMerge.dll" />  
        </ItemGroup>  
  
        <Delete Files="@(FilesToDelete)" ContinueOnError="true">  
            <Output TaskParameter="DeletedFiles" ItemName="FileDeleted" />  
        </Delete>  
  
        <Message Importance="high" Text="Deleted file: %(FileDeleted.Identity)" />  
    </Target>  
      
    <Target Name="CopyFiles" AfterTargets="RemoveLibrariesBeforeBuild">  
        <ItemGroup>  
            <RootItem Include="$(ProjectDir)*.addin" />  
            <AddinItem Include="$(TargetDir)\**\*.*" Exclude="$(TargetDir)*.pdb;$(TargetDir)*.config" />  
        </ItemGroup>  
  
        <Copy SourceFiles="@(RootItem)" DestinationFolder="$(ProgramData)\Autodesk\Revit\Addins\$(RevitVersion)" Condition="$(Configuration.Contains('Debug'))" OverwriteReadOnlyFiles="false" />  
        <Copy SourceFiles="@(AddinItem)" DestinationFolder="$(ProgramData)\Autodesk\Revit\Addins\$(RevitVersion)\Eneca\ClashesManager.Revit\%(RecursiveDir)" Condition="$(Configuration.Contains('Debug'))" OverwriteReadOnlyFiles="false" />  
    </Target>  
  
    <PropertyGroup>  
        <Description>Clashes Manager Plug-in for Revit</Description>  
        <GenerateAssemblyInfo>true</GenerateAssemblyInfo>  
        <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>  
        <ProjectGuid>{ca973dc4-630e-43f5-8b8f-ea75e8f1bed9}</ProjectGuid>  
        <Product>Eneca$(AssemblyName)</Product>  
        <ProductVersion>2024</ProductVersion>  
        <Company>LLC Eneca</Company>  
        <Copyright>https://eneca.nl/</Copyright>  
        <Authors>Eneca</Authors>  
        <AssemblyVersion>1.0.0.24</AssemblyVersion>  
        <FileVersion>1.0.0.24</FileVersion>  
    </PropertyGroup>  
</Project>